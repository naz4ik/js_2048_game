const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],e=0){this.board=t,this.currentBoard=[...t],this.initialScore=e,this.currentScore=e,this.status="idle",this.hasWon=!1}addRandomTile(){let t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++)0===this.board[e][r]&&t.push({row:e,col:r});if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}}slideTiles(t){for(let e=0;e<4;e++){let r=t[e];r=this.combineTiles(r);for(let t=0;t<4;t++)this.board[t][e]=r[t]}}combineTiles(t){let e=t.filter(t=>0!==t),r=0;for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,r+=e[t]);let s=e.filter(t=>0!==t).concat([0,0,0,0]).slice(0,4);return this.currentScore+=r,s}cellsGroupedByColumn(){let t=[[],[],[],[]];for(let e=0;e<4;e++)for(let r=0;r<4;r++)t[e].push(this.board[r][e]);return t}cellsGroupedByRow(){let t=[[],[],[],[]];for(let e=0;e<4;e++)for(let r=0;r<4;r++)t[e].push(this.board[e][r]);return t}moveLeft(){let t=JSON.stringify(this.board),e=this.cellsGroupedByRow();for(let t=0;t<4;t++){let r=e[t];r=this.combineTiles(r),this.board[t]=r}JSON.stringify(this.board)!==t&&this.addRandomTile()}moveRight(){let t=JSON.stringify(this.board),e=this.cellsGroupedByRow();for(let t=0;t<4;t++){let r=e[t].reverse();(r=this.combineTiles(r)).reverse(),this.board[t]=r}JSON.stringify(this.board)!==t&&this.addRandomTile()}moveUp(){let t=JSON.stringify(this.board),e=this.cellsGroupedByColumn();for(let t=0;t<4;t++){let r=e[t];r=this.combineTiles(r);for(let e=0;e<4;e++)this.board[e][t]=r[e]}JSON.stringify(this.board)!==t&&this.addRandomTile()}moveDown(){let t=JSON.stringify(this.board),e=this.cellsGroupedByColumn();for(let t=0;t<4;t++){let r=e[t].reverse();(r=this.combineTiles(r)).reverse();for(let e=0;e<4;e++)this.board[e][t]=r[e]}JSON.stringify(this.board)!==t&&this.addRandomTile()}win(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.board[t][e])return this.hasWon=!0,!0;return!1}canMove(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return!0;return!1}getScore(){return this.currentScore}getState(){return this.board}getStatus(){return this.status}start(){this.currentBoard=JSON.parse(JSON.stringify(this.board)),this.currentScore=this.initialScore,this.addRandomTile(),this.addRandomTile(),this.status="playing"}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.currentBoard=JSON.parse(JSON.stringify(this.board)),this.currentScore=this.initialScore,this.status="idle",this.hasWon=!1}},e=document.querySelector(".start"),r=document.querySelector(".game-field"),s=document.querySelector(".message-start"),i=document.querySelector(".message-lose"),o=document.querySelector(".message-win");function l(){let e=r.querySelectorAll(".field-row"),s=t.getScore();document.querySelector(".game-score").textContent=s,t.getState().forEach((t,r)=>{let s=e[r].querySelectorAll(".field-cell");t.forEach((t,e)=>{let r=s[e];r.textContent="",r.className="field-cell",0!==t&&(r.textContent=t,r.classList.add(`field-cell--${t}`))})})}e.addEventListener("click",()=>{"idle"===t.getStatus()?(t.start(),l(t),e.textContent="Restart",e.classList.add("restart"),s.classList.add("hidden")):"playing"===t.getStatus()&&(t.restart(),l(t),e.textContent="Start",e.classList.remove("restart"),o.classList.add("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"))}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;default:return}t.win()&&t.hasWon&&o.classList.remove("hidden"),t.canMove()||i.classList.remove("hidden"),l()}});
//# sourceMappingURL=index.e1828d3a.js.map
